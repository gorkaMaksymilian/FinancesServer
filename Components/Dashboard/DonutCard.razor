@using Models.Dashboard

<MudCard>
    <MudCardHeader style="padding-bottom: 0px;">
        <CardHeaderContent>
            <MudText Typo="Typo.overline" Color="@headerColor" Style="font-size: 1.2rem">
                @title!.ToUpper() BY CATEGORY
            </MudText>
        </CardHeaderContent>
    </MudCardHeader>

    <MudCardContent style="padding-top: 0px; padding-bottom: 32px;">
        <MudChart ChartType="ChartType.Donut" Width="300px" Height="300px" InputData="@AmountArray" InputLabels="@Labels" 
                  SelectedIndexChanged="@( (newIndex) => ChangeIndexAndInfo(newIndex))"/>
        <MudText Typo="Typo.body1">@selectedCategoryInfo</MudText>
    </MudCardContent>
</MudCard>



@code {
    []
    public string[]? Labels {get;set;}

    private int Index = -1;
    string? title;
    Color headerColor;
    string? selectedCategoryInfo = "Select category by clicking on chart segment";


    protected override void OnInitialized()
    {
        if (Controller == ControllerEnum.Earnings) {
            title = "Earnings"; 
            headerColor = Color.Success;
        }

        StateHasChanged();
    }

    protected void ChangeIndexAndInfo(int newIndex) 
    {
        Index = newIndex;
        selectedCategoryInfo = $"{}";
    }

    [Parameter, EditorRequired]
    public double[]? AmountArray {get;set;}

    [Parameter, EditorRequired]
    public string[]? Labels {get;set;}

    [Parameter, EditorRequired]
    public ControllerEnum Controller {get;set;}



}